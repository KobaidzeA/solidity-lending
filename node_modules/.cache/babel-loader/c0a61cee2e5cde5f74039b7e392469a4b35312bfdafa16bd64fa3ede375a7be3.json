{"ast":null,"code":"var _jsxFileName = \"/home/ak/Desktop/react/v1/src/components/BorrowerButtons.js\";\nimport { myContract } from \"./SmartContract\";\nimport { web3 } from \"./SmartContract\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst accounts = await web3.eth.getAccounts();\nconst converter = 100;\nconst lenderData = await myContract.methods.lenderArrJS().call();\nconst borrowerData = await myContract.methods.borrowerArrJS().call();\nasync function closeAcc() {\n  try {\n    await myContract.methods.closeBorrower(100).send({\n      from: accounts[0]\n    });\n  } catch (error) {\n    console.log(error);\n  }\n}\nlet notBlockedLenders = [];\nfor (let i = 0; i < lenderData.length; i++) {\n  if (lenderData[i][4] === false) {\n    notBlockedLenders.push(lenderData[i]);\n  }\n}\nconst customSort = (a, b) => b[2] - a[2];\nvar sortedLenders = [...notBlockedLenders].sort(customSort);\nasync function getLoan() {\n  let myUser = [];\n  for (let i = 0; i < borrowerData.length; i++) {\n    if (accounts[0] === borrowerData[i][0]) {\n      myUser = borrowerData[i];\n    }\n  }\n  console.log(parseInt(myUser[1], 10) * 20);\n  var loanAmount = window.prompt(\"Enter the amount you wish to borrow, your limit is \" + parseInt(myUser[1], 10) * converter + \" wei\");\n  if (loanAmount === null || isNaN(parseInt(loanAmount))) {\n    alert(\"Invalid amount input!\");\n    return;\n  }\n  var forSort = parseInt(loanAmount, 10);\n  var lenderArr = [];\n  var lenderAmounts = [];\n  if (loanAmount > myUser[1] * converter) {\n    alert(\"The amount you have entered is more than your limit! try again\");\n    return;\n  }\n  for (var i = 0; i < sortedLenders.length; i++) {\n    console.log(parseInt(sortedLenders[i][2], 10));\n    forSort -= parseInt(sortedLenders[i][2], 10);\n    lenderArr.push(sortedLenders[i][0]);\n    lenderAmounts.push(parseInt(sortedLenders[i][1], 10));\n    if (forSort < 0) {\n      console.log(\"recorded it being less\");\n      lenderAmounts[i] = lenderAmounts[i] - forSort * -1;\n      console.log(lenderAmounts[i] - forSort * -1);\n      break;\n    }\n  }\n  console.log(lenderArr);\n  console.log(lenderAmounts);\n  alert(\"Accept every transaction!\");\n  const batch = new web3.BatchRequest();\n  for (var i = 0; i < lenderAmounts.length; i++) {\n    batch.add(myContract.methods.updateLoan(accounts[0], lenderArr[i], lenderAmounts[i]).send.request({\n      from: accounts[0]\n    }));\n  }\n  batch.add(myContract.methods.borrowMoney(loanAmount).send.request({\n    from: accounts[0]\n  }));\n  batch.execute();\n}\nasync function repay() {\n  try {\n    const myLoan = await myContract.methods.getSpecificLoan(accounts[0]).call({\n      from: accounts[0]\n    });\n    var totalDebtAmount = 0;\n    for (var i = 0; i < myLoan[1].length; i++) {\n      totalDebtAmount += parseInt(myLoan[1][i], 10);\n      console.log(\"for cycle did = \" + totalDebtAmount);\n    }\n    console.log(\"paying back =\" + totalDebtAmount);\n    await myContract.methods.payBack().send({\n      from: accounts[0],\n      value: totalDebtAmount * 2\n    });\n  } catch (error) {\n    console.log(error);\n  }\n}\nexport default function BorrowerButtons() {\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"functionDiv\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"buttonContainer\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: closeAcc,\n          className: \"functionButton\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"closeSpan\",\n            children: \"Close Account\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 68\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"buttonContainer\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: getLoan,\n          className: \"functionButton\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"loanSpan\",\n            children: \"Get a Loan\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 66\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"buttonContainer\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: repay,\n          className: \"functionButton\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"repaySpan\",\n            children: \"Pay back\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 64\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 9\n    }, this)\n  }, void 0, false);\n}\n_c = BorrowerButtons;\nvar _c;\n$RefreshReg$(_c, \"BorrowerButtons\");","map":{"version":3,"names":["myContract","web3","jsxDEV","_jsxDEV","Fragment","_Fragment","accounts","eth","getAccounts","converter","lenderData","methods","lenderArrJS","call","borrowerData","borrowerArrJS","closeAcc","closeBorrower","send","from","error","console","log","notBlockedLenders","i","length","push","customSort","a","b","sortedLenders","sort","getLoan","myUser","parseInt","loanAmount","window","prompt","isNaN","alert","forSort","lenderArr","lenderAmounts","batch","BatchRequest","add","updateLoan","request","borrowMoney","execute","repay","myLoan","getSpecificLoan","totalDebtAmount","payBack","value","BorrowerButtons","children","className","onClick","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/home/ak/Desktop/react/v1/src/components/BorrowerButtons.js"],"sourcesContent":["import { myContract } from \"./SmartContract\";\nimport { web3 } from \"./SmartContract\";\nconst accounts = await web3.eth.getAccounts();\nconst converter = 100;\nconst lenderData = await myContract.methods.lenderArrJS().call();\nconst borrowerData = await myContract.methods.borrowerArrJS().call();\nasync function closeAcc() {\n    try {\n        await myContract.methods.closeBorrower(100).send({\n            from: accounts[0]\n        });\n    } catch(error) {\n        console.log(error);\n    }\n}\nlet notBlockedLenders = [];\nfor(let i = 0; i < lenderData.length; i++) {\n    if(lenderData[i][4] === false) {\n        notBlockedLenders.push(lenderData[i]);\n    }\n}\nconst customSort =(a,b) => b[2] - a[2];\nvar sortedLenders = [...notBlockedLenders].sort(customSort);\nasync function getLoan() {\n    let myUser = [];\n    for(let i = 0 ; i < borrowerData.length; i++) {\n        if(accounts[0] === borrowerData[i][0]) {\n            myUser = borrowerData[i];\n        }\n    }\n    console.log(parseInt(myUser[1],10)*20);\n    var loanAmount = window.prompt(\"Enter the amount you wish to borrow, your limit is \"+parseInt(myUser[1],10)*converter+\" wei\");\n    if(loanAmount === null || isNaN(parseInt(loanAmount))) {\n        alert(\"Invalid amount input!\");\n        return;\n    }\n    var forSort = parseInt(loanAmount,10);\n    var lenderArr =[];\n    var lenderAmounts = [];\n    if(loanAmount > myUser[1]*converter) {\n        alert(\"The amount you have entered is more than your limit! try again\");\n        return\n    } \n    for(var i=0; i<sortedLenders.length; i++) {\n        console.log(parseInt(sortedLenders[i][2],10));\n        forSort -= parseInt(sortedLenders[i][2],10);\n        lenderArr.push(sortedLenders[i][0]);\n        lenderAmounts.push(parseInt(sortedLenders[i][1],10));\n        if(forSort < 0) {\n            console.log(\"recorded it being less\");\n            lenderAmounts[i] = lenderAmounts[i] - forSort*-1;\n            console.log(lenderAmounts[i] - forSort*-1);\n            break; \n        }\n        \n    }\n    console.log(lenderArr);\n    console.log(lenderAmounts);\n    alert(\"Accept every transaction!\");\n    const batch = new web3.BatchRequest();\n     for(var i=0; i<lenderAmounts.length; i++) {\n        batch.add(myContract.methods.updateLoan(accounts[0],lenderArr[i],lenderAmounts[i]).send.request({\n            from: accounts[0]\n        }));\n    }\n    batch.add(myContract.methods.borrowMoney(loanAmount).send.request({from: accounts[0]}));\n    batch.execute();\n}\n\nasync function repay() {\n    try {\n        const myLoan = await myContract.methods.getSpecificLoan(accounts[0]).call({\n            from: accounts[0]\n        });\n        var totalDebtAmount=0;\n        for(var i=0; i<myLoan[1].length; i++) {\n            totalDebtAmount += parseInt(myLoan[1][i],10);\n            console.log(\"for cycle did = \"+totalDebtAmount);\n        }\n        console.log(\"paying back =\"+totalDebtAmount);\n        await myContract.methods.payBack().send({\n            from: accounts[0],\n            value: totalDebtAmount*2\n        });\n    } catch(error) {\n        console.log(error);\n    }\n}\n\nexport default function BorrowerButtons() {\n    return(\n        <>\n        <div className=\"functionDiv\"> \n            <div className=\"buttonContainer\">\n            <button  onClick={closeAcc} className=\"functionButton\"><span className=\"closeSpan\">Close Account</span></button>\n            </div>\n            <div className=\"buttonContainer\">\n            <button onClick={getLoan} className=\"functionButton\"><span className=\"loanSpan\">Get a Loan</span></button>\n            </div>\n            <div className=\"buttonContainer\">\n            <button onClick={repay} className=\"functionButton\"><span className=\"repaySpan\">Pay back</span></button>\n            </div>\n        </div>\n        </>\n    )\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}